    from ReloadEffect import SimpleReload, BARREL_DEBUG_ENABLED, playByName
    from debug_utils import LOG_DEBUG
    from helpers import gEffectsDisabled
    def ivmEmptyShells(self):
            old_BarrelReload_start = ReloadEffect.BarrelReload_start

            def IVM_BarrelReload_Start(self, shellReloadTime, alert, shellCount, reloadShellCount, shellID, reloadStart):
                old_BarrelReload_start(self, shellReloadTime, alert, shellCount, reloadShellCount, shellID, reloadStart)
                if gEffectsDisabled():
                    return
                SoundGroups.g_instance.setSwitch('SWITCH_ext_rld_automat_caliber', self._desc.caliber)
                currentTime = BigWorld.time()
                if shellCount == 0:
                    SoundGroups_g_instance.playSound2D(config.data['emptyShellsEvent'])
                    self.stopCallback(self._startOneShoot)
                    self.__reloadSequence.schedule(shellReloadTime, reloadShellCount)
                    if reloadStart:
                        playByName(self._desc.startLong)
                        if BARREL_DEBUG_ENABLED:
                            LOG_DEBUG('!!! Play Long  = {0} {1}'.format(currentTime, self._desc.startLong))
                    if alert:
                        playByName(self._desc.ammoLow)
                        if BARREL_DEBUG_ENABLED:
                            LOG_DEBUG('!!! Play Ammo Low  = {0} {1}'.format(currentTime, self._desc.ammoLow))
                else:
                    if shellCount == 1 and reloadShellCount > 2:
                        SoundGroups_g_instance.playSound2D(config.data['almostOutEvent'])
                        if BARREL_DEBUG_ENABLED:
                            LOG_DEBUG('!!! Play Alert  = {0} {1}'.format(currentTime, self._desc.lastShellAlert))
                        playByName(self._desc.lastShellAlert)
                    time = shellReloadTime - self._desc.shellDuration
                    self.delayCallback(time, self._startOneShoot, currentTime + time)

            ReloadEffect.BarrelReload_start = IVM_BarrelReload_Start